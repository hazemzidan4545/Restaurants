{% extends "shared/base.html" %}

{% block title %}Services - Restaurant Management System{% endblock %}

{% block extra_css %}
<style>


/* Hero section styles are now in the shared CSS file */

:root {
    --primary-yellow: #f3cd21;
    --primary-dark: #1c1d1f;
    --text-dark: #333;
}

/* Remove the services-page-container wrapper to use base template styling */

.services-section {
    padding: 60px 20px;
    background: white;
    text-align: center;
}

.services-title {
    text-align: center;
    margin-bottom: 40px;
    font-size: 1.5rem;
    font-weight: 600;
    color: #333;
}

.services-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    max-width: 1200px;
    margin: 0 auto;
}

.service-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 15px;
    transition: all 0.3s ease;
    cursor: pointer;
    border: 2px solid transparent;
}

.service-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    border-color: #ffc107;
}

.service-icon {
    width: 60px;
    height: 60px;
    background: #ffc107;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
    font-size: 24px;
    color: #333;
}

.service-name {
    font-size: 0.9rem;
    font-weight: 500;
    color: #333;
    margin: 0;
}

/* Footer styles are handled by the base template */

/* Responsive Design */
@media (max-width: 768px) {
    .services-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
    }

    .service-item {
        padding: 15px;
    }

    .service-icon {
        width: 50px;
        height: 50px;
        font-size: 20px;
    }
}

@media (max-width: 480px) {
    .services-grid {
        grid-template-columns: 1fr;
        max-width: 300px;
        margin: 0 auto;
    }

    .services-section {
        padding: 40px 15px;
    }
}

.no-services {
    grid-column: 1 / -1;
    text-align: center;
    padding: 40px 20px;
    color: #666;
    font-style: italic;
}

.no-services p {
    margin: 0;
    font-size: 1.1rem;
}
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero-section">
    <div class="hero-content">
        <h1>Welcome to Hive Restaurant<br></h1>
            <p>Explore our services from the comfort of your table</p>
        <div class="hero-buttons">
            <a href="{{ url_for('customer.menu') }}" class="hero-btn primary">Menu</a>
            <a href="{{ url_for('service.index') }}" class="hero-btn secondary">Services</a>
        </div>
    </div>
</div>

<!-- Services Section -->
<div class="services-section">
    <h2 class="services-title">Services we provide</h2>
    <div class="services-grid">
        {% if services %}
            {% for service in services %}
            <div class="service-item" onclick="submitServiceRequest('{{ service.service_id }}', '{{ service.name }}', '{{ service.description or service.name }}')">
                <div class="service-icon">
                    <i class="{{ service.icon }}"></i>
                </div>
                <p class="service-name">{{ service.name }}</p>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-services">
                <p>No services available at the moment.</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Service request functionality
function submitServiceRequest(serviceId, serviceName, serviceDescription) {
    // Get table ID from user
    let tableId = sessionStorage.getItem('currentTableId');
    if (!tableId) {
        tableId = prompt('Please enter your table number (1-10):');
        if (!tableId || isNaN(tableId)) {
            alert('Please enter a valid table number.');
            return;
        }
        sessionStorage.setItem('currentTableId', tableId);
    }
    
    // Handle special cases for certain services
    let description = serviceDescription;
    let confirmText = `Request ${serviceName} for your table?`;
    
    // Special handling for AC adjustment
    if (serviceName.toLowerCase().includes('ac') || serviceName.toLowerCase().includes('air')) {
        const preference = prompt('Please specify your AC preference (warmer/cooler):');
        if (!preference) return;
        description = `AC adjustment: ${preference}`;
        confirmText = 'Submit AC adjustment request?';
    }
    
    // Special handling for custom request
    if (serviceName.toLowerCase().includes('custom')) {
        const customDesc = prompt('Please describe your custom request:');
        if (!customDesc) return;
        description = customDesc;
        confirmText = 'Submit your custom request?';
    }
    
    // Confirm the request
    if (!confirm(confirmText)) {
        return;
    }
    
    // Submit the request
    const requestData = {
        service_id: serviceId,
        table_id: parseInt(tableId),
        description: description
    };
    
    fetch('/service/api/request', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(requestData)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
        if (data.request_id) {
            alert(`✅ ${serviceName} request submitted successfully!\n\nRequest ID: ${data.request_id}\nTable: ${tableId}\n\nOur staff will assist you shortly.`);
        } else {
            alert(`❌ Error: ${data.error || 'Failed to submit request'}`);
        }
    })
    .catch(error => {
        console.error('Error submitting service request:', error);
        alert(`❌ Failed to submit request: ${error.message}\n\nPlease try again or contact staff directly.`);
    });
}
</script>
{% endblock %}
